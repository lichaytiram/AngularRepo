<div *ngIf="user$ | async as user">

    <div>

        <button (click)="logout()" class="text-primary m-1"><i class="fas fa-sign-out-alt"></i> Log
            Out</button><br>
        <button (click)="deleteAccount(user.id)" class="text-danger m-1"><i class="fas fa-minus-circle"></i> Delete
            Account</button>

    </div>

    <div class="container">

        <div>

            <h5 class="text-center">Your user</h5>

            <form #userForm="ngForm">

                <div class="row justify-content-center">

                    <label class="col-4 col-sm-3 col-md-2 col-lg-1 col-xl-1 p-0">username: </label>
                    <span *ngIf="!editToggle"
                        class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0">{{user.username}}</span>
                    <input *ngIf="editToggle && !usernameToggle" type="button" value="&#xf4ff; Edit username"
                        (click)="nameToggle('username')" class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0 fas">

                    <div [class.d-none]="!editToggle || editToggle && !usernameToggle"
                        class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0">

                        <small class="text-danger" [class.d-none]="username.untouched || username.valid">
                            Must to enter only three letters at least</small>

                        <input type="text" title="Enter an username" name="username" #username="ngModel"
                            [(ngModel)]="newUser.username" required pattern="^[a-zA-Z]{3,}$"
                            [class.border-danger]="username.invalid && username.touched"
                            class="rounded-pill border border-primary text-center">

                        <div class="row justify-content-around p-1">

                            <input type="button" value="&#xf410; Cancel" (click)="cancelTogglesOff(username)"
                                class="far text-danger">
                            <input type="button" value="&#xf0c7; Save" [disabled]="username.invalid"
                                (click)="updateUser(user,'username')" class="btn far text-primary">

                        </div>

                    </div>

                </div>

                <div class="row justify-content-center">

                    <label class="col-4 col-sm-3 col-md-2 col-lg-1 col-xl-1 p-0">password: </label>
                    <span *ngIf="!editToggle"
                        class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0">{{user.password}}</span>
                    <input *ngIf="editToggle && !passwordToggle" type="button" value="&#xf4ff; Edit password"
                        (click)="nameToggle('password')" class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0 fas">

                    <div [class.d-none]="!editToggle || editToggle && !passwordToggle"
                        class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0">

                        <div class="text-danger" [class.d-none]="password.untouched || password.valid">
                            <small>Must to enter eight letters at least.</small><br>
                            <small>(one upper case one lower case and a number)</small>
                        </div>

                        <input type="password" title="Enter a password" name="password" #password="ngModel"
                            [(ngModel)]="newUser.password" required
                            pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$"
                            [class.border-danger]="password.invalid && password.touched"
                            class="rounded-pill border border-primary">

                    </div>

                </div>

                <div class="row justify-content-center" [class.d-none]="!editToggle || editToggle && !passwordToggle">

                    <label class="col-4 col-sm-3 col-md-2 col-lg-1 col-xl-1 p-0">confirm: </label>
                    <span *ngIf="!editToggle"
                        class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0">{{user.confirmPassword}}</span>
                    <span *ngIf="editToggle && !passwordToggle"
                        class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0"></span>

                    <div [class.d-none]="!editToggle || editToggle && !passwordToggle"
                        class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0">

                        <div class="text-danger"
                            [class.d-none]="confirmPassword.untouched || confirmPassword.valid && confirmPassword.value===password.value">
                            <small>Your passwords isn't match!</small><br>
                            <small>Please try again.</small>
                        </div>

                        <input type="password" title="Enter again a password to confirm" name="confirmPassword"
                            #confirmPassword="ngModel" [(ngModel)]="newUser.confirmPassword" required
                            pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$" [disabled]="password.invalid"
                            [class.border-danger]="(confirmPassword.touched && confirmPassword.value!==password.value)"
                            class="rounded-pill border border-primary">

                        <div class="row justify-content-around p-1">

                            <input type="button" value="&#xf410; Cancel"
                                (click)="cancelTogglesOff(password,confirmPassword)" class="far text-danger">
                            <input type="button" value="&#xf0c7; Save"
                                [disabled]="confirmPassword.value!==password.value || password.invalid"
                                (click)="updateUser(user,'password')" class="btn far text-primary">

                        </div>

                    </div>

                </div>

                <div class="row justify-content-center">

                    <label class="col-4 col-sm-3 col-md-2 col-lg-1 col-xl-1 p-0">gender: </label>
                    <span *ngIf="!editToggle"
                        class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0">{{user.gender}}</span>
                    <input *ngIf="editToggle && !genderToggle" type="button" value="&#xf4ff; Edit gender"
                        (click)="nameToggle('gender')" class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0 fas">

                    <div [class.d-none]="!editToggle || editToggle && !genderToggle"
                        class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0">

                        <label>
                            <input type="radio" name="male" #male="ngModel" value="Male" required
                                [(ngModel)]="newUser.gender">
                            <span class="rounded-pill text-center m-1 radioMale"><i class="fas fa-male m-1"></i></span>
                        </label>

                        <label>
                            <input type="radio" name="female" #female="ngModel" value="Female" required
                                [(ngModel)]="newUser.gender">
                            <span class="rounded-pill text-center m-1 radioFemale"><i
                                    class="fas fa-female m-1"></i></span>
                        </label>

                        <div class="row justify-content-around p-1">

                            <input type="button" value="&#xf410; Cancel" (click)="cancelTogglesOff()"
                                class="far text-danger">
                            <input type="button" value="&#xf0c7; Save" [disabled]="male.invalid && female.invalid" (click)="updateUser(user,'gender')"
                                class="btn far text-primary">

                        </div>

                    </div>

                </div>

                <div class="row justify-content-center">

                    <label class="col-4 col-sm-3 col-md-2 col-lg-1 col-xl-1 p-0">weight: </label>
                    <span *ngIf="!editToggle"
                        class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0">{{user.weight}}</span>
                    <input *ngIf="editToggle && !weightToggle" type="button" value="&#xf4ff; Edit weight"
                        (click)="nameToggle('weight')" class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0 fas">

                    <div [class.d-none]="!editToggle || editToggle && !weightToggle"
                        class="col-5 col-sm-4 col-md-3 col-lg-2 col-xl-2 p-0">

                        <small class="text-danger" [class.d-none]="weight.untouched || weight.valid">Your weight
                            must be greater than 0</small>

                        <input type="number" title="Enter your weight" name="weight" #weight="ngModel"
                            [(ngModel)]="newUser.weight" required pattern="^[1-9]\d*$"
                            [class.border-danger]="weight.invalid && weight.touched"
                            class="rounded-pill border border-primary">

                        <div class="row justify-content-around p-1">

                            <input type="button" value="&#xf410; Cancel" (click)="cancelTogglesOff(weight)"
                                class="far text-danger">
                            <input type="button" value="&#xf0c7; Save" [disabled]="weight.invalid" (click)="updateUser(user,'weight')"
                                class="btn far text-primary">

                        </div>

                    </div>

                </div>

            </form>

        </div>

        <div class="text-center">
            <input type="button" value="&#xf4ff; Edit account" (click)="editToggleOn()" class="fas text-primary"><br>
            <input type="button" value="&#xf410; Cancel edit" [class.d-none]="!editToggle"
                (click)="editToggleOff(userForm)" class="far text-danger">
        </div>

    </div>

</div>